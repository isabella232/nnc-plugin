Split Image
~~~~~~~~~~~

データセットCSVファイルに含まれる高解像度の画像を元の画像よりも小さなパッチ画像に分割し、各パッチをデータとするデータセットCSVファイルを作成します。画像の信号処理やセグメンテーションタスクにおいて元の高解像度の画像が1つのニューラルネットワークで処理しきれないような場合にも、本プラグインを用いて画像を元の画像より小さいパッチ画像に分割することで処理の実行が可能になります。

.. image:: figures/SplitImage1.png
   :align: center


.. list-table::
   :widths: 30 70
   :class: longtable

   * - input-csv
     - 変換元のデータセットCSVファイルを指定します

   * - input-variable1
     -
        データセットCSVファイルに含まれる変数のうち、分割対象の画像の変数名を指定します
        
        同じサイズの画像を含む複数の変数をパッチ画像に分割する場合は、カンマ区切りで複数の変数名を指定します

   * - patch-size1
     - 分割先の画像のサイズをピクセル単位で指定します

   * - overlap-size1
     - 隣のパッチと重複させる画像サイズをピクセル単位で指定します

   * -
        input-variable2
        
        patch-size2
        
        overlap-size2
     - 1つのデータセットCSVファイルに分割対象の画像が複数含まれ、かつinput-variable1で指定した変数とは異なる設定値での画像分割を行う場合に使用します

   * - output-dir
     - コンバート後のデータセットCSVファイルの出力フォルダを指定します

   * - shuffle
     -
        コンバート後のデータセットCSVファイルの各行のシャッフルを実施するかどうかを指定します
        
        true : ランダムにシャッフルを行います
        
        false : シャッフルを行いません

   * -
        output_file1
        
        output_file2
     - コンバート後のデータセットCSVファイル1,2のファイル名を指定します

   * -
        ratio1
        
        ratio2
     -
        コンバート後のデータセットCSVファイル1,2に用いるデータの割合を指定します
        
        ratio1, ratio2の割合の合計は100 (%)である必要があります
        
        ratio2が0である場合、output_file1にすべてのデータが出力されます


本プラグインは、出力データセットCSVファイルに画像の再合成に必要な以下の変数を出力します。



.. list-table::
   :widths: 30 70
   :class: longtable

   * - index
     - 変換元データセットCSVファイルにおけるデータのインデックス

   * - original_height
     - 変換元画像の高さ（変数毎に出力）

   * - original_width
     - 変換元画像の幅（変数毎に出力）

   * - patch_size
     - パッチサイズ（変数毎に出力）

   * - top, left
     - 変換元画像におけるパッチの左上のy, x座標（変数毎に出力）


.. image:: figures/SplitImage2.png
   :align: center


**ご参考**

本プラグインを用いて分割した画像は、後処理プラグインとして用意されているRestore Split Imageプラグインで元の高解像度の画像に復元することができます。

変換元データセットCSVファイルに含まれる画像のサイズや縦横比は統一されている必要はありません。

本プラグインは画像分割時、出力画像のうち元画像に含まれない箇所を0でパディングします。

